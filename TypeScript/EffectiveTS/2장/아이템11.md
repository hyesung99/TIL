# 초과 프로퍼티 체크(잉여 속성 검사)의 한계 인지하기

<strong>구조적 타이핑에 익숙해지기</strong>을 보고 온 사람이라면 다음과 같은 의문이 들 것이다.

```typescript
interface Elemental {
  name: string
  age: number
}

const wade : Elemental = {
  type: 'water', //에러 발생
  age: 12,
  name: 'wade',
}
```

구조적 타이핑 관점으로 봤을때 ember는 Elemental의 name과 age의 프로퍼티를 가지고 있기 때문에
같은 구조로 볼 수 있어 Elemental 타입에 호환 가능할 것 처럼 보인다.
하지만 Elemental형식에 'type'이라는 프로퍼티가 없다는 에러를 발생시킨다.

반면에 다음 코드는 에러가 발생하지 않는다.
```typescript
const tmpEmber = {
  type: 'fire',
  age: 12,
  name: 'ember'
}

const ember : Elemental = tmpEmber
```

둘의 유일한 차이는 wade는 객체 리터럴을 사용했고 ember는 임시변수를 사용해 객체릴 할당했다는 것이다.
그렇다면 객체 리터럴을 할당했을때 구조적 타이핑의 규칙을 따르지 않아 에러가 발생한 걸까?

결론부터 말하자면 wade와 ember모두 구조적 타이핑의 규칙을 따르고 있고, Elemental 타입의 서브타입이다.
따라서 두 방식 모두 타입 호환이 가능하다. 즉 에러가 발생한 이유는 구조적 타이핑과 무관한 것이다.

실제로 에러가 발생한 이유는 <strong>초과 프로퍼티 검사(잉여 속성 검사)</strong> 때문이다.
초과 프로퍼티란 타입에 정의되지 않은 프로퍼티를 말한다.
```typescript
interface Elemental {
  name: string
  age: number
}

//초과 프로퍼티 검사 수행 O, 타입 호환 가능
const wade : Elemental = {
  type: 'water', //에러 발생
  age: 12,
  name: 'wade',
}
```
위 예시를 다시보자. type프로퍼티는 Elemental에 정의되지 않았기 때문에 초과 프로퍼티이다.
또한 객체 리터럴을 변수에 할당했기 때문에 초과 프로퍼티 검사를 수행하여 type이라는 초과 프로퍼티가
발견됐다는 에러를 발생시키는 것이다.

반면에 위에서 봤듯이 임시변수를 사용해 객체 리터럴을 할당했을때는 에러가 발생하지 않는다.
그 이유는 타입스크립트는 객체 리터럴을 변수에 할당할 때, 그리고 함수에 매개변수로 전달할 때만 초과 프로퍼티 검사를 수행하기 때문이다.
```typescript
const tmpEmber = {
  type: 'fire',
  age: 12,
  name: 'ember'
}
//초과 프로퍼티 검사 수행 X, 타입 호환 가능
const ember : Elemental = tmpEmber 
```

필자는 다른 프로퍼티가 존재해도 호환 가능하다는 구조적 타이핑과 다른 프로퍼티가 존재하면 에러가 발생하는
초과 프로퍼티 검사가 동시에 존재한다는 개념이 이해하기 힘들었다.
초과 프로퍼티 검사를 실행함과 동시에 구조적 타이핑의 특성은 활용할 수 없는 것이다.

이러한 혼동은 타입스크립트가 자바스크립트의 동적 타이핑의 장점과 타입스크립트의 핵심 기능인
정적 타이핑의 장점을 모두 가져가기 위해서 발생한 것이라고 생각한다.

전 글에서는 다형성을 근거로 장점을 설명했지만 다시 구체적으로 말하면 자바스크립트는 런타임에 타입이 결정되는
동적 타이핑 언어이기 때문에 사용이 유연하다는 장점이 있다. 그 장점을 살리기 위해 타입스크립트는 구조적 타이핑을
채택했다.

동시에 타입스크립트는 기본적으로 정적 타이핑 언어이다. 타입스크립트는 정적 타이핑을 지원함으로써
런타임에 발생할 수 있는 오류를 사전에 방지한다. 그렇기 떄문에 초과 프로퍼티 검사를 수행한다.

이처럼 타입스크립트는 양립할 수 없는 두 개념의 장점을 모두 가져오기 위해 초과 프로퍼티 검사시기를 객체 리터럴을 변수에 할당할 때와 함수의 매개변수로 전달할 때로
제한한 것이 아닌가라는 생각이 든다.

개발자가 초과 프로퍼티 검사 시점을 정확히 이해하고 있다면 정적과 동적 타이핑의 장점을 모두 가져가면서
타입스크립트를 사용할 수 있을 것이다.


